(function () {
  "use strict";
  function initScrollAnimations() {
    const prefersReducedMotion = window.matchMedia(
      "(prefers-reduced-motion: reduce)"
    ).matches;
    if (prefersReducedMotion) {
      const animatedElements = document.querySelectorAll(
        ".fade-in-scroll, .slide-in-left, .slide-in-right, .scale-in-scroll"
      );
      animatedElements.forEach((element) => {
        element.classList.add("visible");
      });
      return;
    }
    const observerOptions = { threshold: 0.1, rootMargin: "0px 0px -50px 0px" };
    const observer = new IntersectionObserver((entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          entry.target.classList.add("visible");
          observer.unobserve(entry.target);
        }
      });
    }, observerOptions);
    const animatedElements = document.querySelectorAll(
      ".fade-in-scroll, .slide-in-left, .slide-in-right, .scale-in-scroll"
    );
    animatedElements.forEach((element) => {
      observer.observe(element);
    });
  }
  function initEnhancedHoverEffects() {
    const cards = document.querySelectorAll(".card");
    cards.forEach((card) => {
      if (!card.classList.contains("card--accent")) {
        card.classList.add("card-hover-lift");
      }
    });
    const buttons = document.querySelectorAll(".btn");
    buttons.forEach((button) => {
      button.classList.add("btn-hover-lift");
    });
    const imageContainers = document.querySelectorAll(".card__image");
    imageContainers.forEach((container) => {
      container.classList.add("image-hover-zoom");
    });
    const navLinks = document.querySelectorAll(
      ".nav__link:not(.nav__link--active)"
    );
    navLinks.forEach((link) => {
      link.classList.add("text-hover-underline");
    });
  }
  function initFocusEnhancements() {
    const focusElements = document.querySelectorAll(
      "button, a, input, textarea, select"
    );
    focusElements.forEach((element) => {
      element.classList.add("focus-ring-animated");
    });
  }
  function initKeyboardNavigation() {
    document.addEventListener("keydown", (e) => {
      if (e.key === "Escape") {
        const mobileMenu = document.getElementById("mobile-menu");
        if (mobileMenu && mobileMenu.getAttribute("aria-hidden") === "false") {
        }
      }
    });
    const mobileMenu = document.getElementById("mobile-menu");
    if (mobileMenu) {
      const focusableElements = mobileMenu.querySelectorAll(
        'a, button, input, textarea, select, [tabindex]:not([tabindex="-1"])'
      );
      if (focusableElements.length > 0) {
        const firstFocusable = focusableElements[0];
        const lastFocusable = focusableElements[focusableElements.length - 1];
        mobileMenu.addEventListener("keydown", (e) => {
          if (e.key === "Tab") {
            if (e.shiftKey) {
              if (document.activeElement === firstFocusable) {
                e.preventDefault();
                lastFocusable.focus();
              }
            } else {
              if (document.activeElement === lastFocusable) {
                e.preventDefault();
                firstFocusable.focus();
              }
            }
          }
        });
      }
    }
    const filterGroups = document.querySelectorAll(
      ".projects-filter-buttons, .filter-buttons"
    );
    filterGroups.forEach((group) => {
      const buttons = group.querySelectorAll("button");
      buttons.forEach((button, index) => {
        button.addEventListener("keydown", (e) => {
          let targetIndex;
          switch (e.key) {
            case "ArrowRight":
            case "ArrowDown":
              e.preventDefault();
              targetIndex = (index + 1) % buttons.length;
              buttons[targetIndex].focus();
              break;
            case "ArrowLeft":
            case "ArrowUp":
              e.preventDefault();
              targetIndex = (index - 1 + buttons.length) % buttons.length;
              buttons[targetIndex].focus();
              break;
            case "Home":
              e.preventDefault();
              buttons[0].focus();
              break;
            case "End":
              e.preventDefault();
              buttons[buttons.length - 1].focus();
              break;
          }
        });
      });
    });
  }
  function createLiveRegion() {
    const liveRegion = document.createElement("div");
    liveRegion.setAttribute("aria-live", "polite");
    liveRegion.setAttribute("aria-atomic", "true");
    liveRegion.className = "sr-only live-region";
    liveRegion.id = "live-region";
    document.body.appendChild(liveRegion);
    return liveRegion;
  }
  function announceToScreenReader(message) {
    const liveRegion =
      document.getElementById("live-region") || createLiveRegion();
    liveRegion.textContent = message;
    setTimeout(() => {
      liveRegion.textContent = "";
    }, 1000);
  }
  function initFormAccessibility() {
    const forms = document.querySelectorAll("form");
    forms.forEach((form) => {
      const inputs = form.querySelectorAll(
        "input[required], textarea[required], select[required]"
      );
      inputs.forEach((input) => {
        let errorContainer = input.parentNode.querySelector(".form-error");
        if (!errorContainer) {
          errorContainer = document.createElement("div");
          errorContainer.className = "form-error";
          errorContainer.setAttribute("aria-live", "polite");
          input.parentNode.appendChild(errorContainer);
        }
        input.addEventListener("invalid", (e) => {
          e.preventDefault();
          const message = getValidationMessage(input);
          errorContainer.textContent = message;
          errorContainer.style.display = "block";
          input.setAttribute(
            "aria-describedby",
            errorContainer.id || "error-" + input.id
          );
          announceToScreenReader(`Error: ${message}`);
        });
        input.addEventListener("input", () => {
          if (input.validity.valid) {
            errorContainer.textContent = "";
            errorContainer.style.display = "none";
            input.removeAttribute("aria-describedby");
          }
        });
      });
    });
  }
  function getValidationMessage(input) {
    if (input.validity.valueMissing) {
      return `${input.labels[0]?.textContent || "This field"} is required`;
    }
    if (input.validity.typeMismatch) {
      return `Please enter a valid ${input.type}`;
    }
    if (input.validity.tooShort) {
      return `Please enter at least ${input.minLength} characters`;
    }
    if (input.validity.tooLong) {
      return `Please enter no more than ${input.maxLength} characters`;
    }
    return "Please check your input";
  }
  function initImageLoadingStates() {
    const images = document.querySelectorAll("img");
    images.forEach((img) => {
      if (!img.complete) {
        const placeholder = document.createElement("div");
        placeholder.className = "image-placeholder";
        placeholder.style.aspectRatio = "16 / 9";
        img.parentNode.insertBefore(placeholder, img);
        img.style.display = "none";
        img.addEventListener("load", () => {
          placeholder.remove();
          img.style.display = "";
          img.classList.add("animate-fade-in");
        });
        img.addEventListener("error", () => {
          placeholder.textContent = "IMAGE FAILED TO LOAD";
          placeholder.style.color = "var(--color-accent-yellow)";
        });
      }
    });
  }
  function init() {
    initScrollAnimations();
    initEnhancedHoverEffects();
    initFocusEnhancements();
    initKeyboardNavigation();
    initFormAccessibility();
    initImageLoadingStates();
    createLiveRegion();
    document.body.classList.add("loaded");
    setTimeout(() => {
      const pageTitle =
        document.querySelector("h1")?.textContent || document.title;
      announceToScreenReader(`Page loaded: ${pageTitle}`);
    }, 1000);
  }
  if (document.readyState === "loading") {
    document.addEventListener("DOMContentLoaded", init);
  } else {
    init();
  }
  const mediaQuery = window.matchMedia("(prefers-reduced-motion: reduce)");
  mediaQuery.addEventListener("change", () => {
    if (mediaQuery.matches) {
      document.body.classList.add("reduce-motion");
    } else {
      document.body.classList.remove("reduce-motion");
    }
  });
})();
